<!DOCTYPE html>
<html lang="en">
<head>
    <script src="trackPlayerInputs.js" defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="index.css">
    <script src="timer.js" defer></script>
    <title>Thumbsup</title>
    <style>
        /* Reset some default styles */
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
        }

        /* Flexbox styles to center content */
        body {
            display: flex;
            justify-content: center;  /* Center horizontally */
            margin-top: 300px;
            height: 100vh;            /* Full viewport height */
            font-family: Arial, sans-serif;
        }

        #thumbsup-button {background-color: #04AA6D; margin-top: 180px; font-size: 35px;}
        #next-button {background-color: #04AA6D; margin-top: 180px; font-size: 35px;}

        #countdown {
            font-size: 18px;
            font-weight: bold;
            margin: 0;
            position: absolute;
            bottom: 25%;  /* Position at the bottom of the page */
            left: 50%;  /* Center it horizontally */
            transform: translateX(-50%);  /* Adjust for exact horizontal centering */
        }

        #time-elapsed {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 18px;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
        }

        .thumbs-text {
            margin-top: 190px;
            font-size: 20px;
        }
    </style>
</head>
<body>
    <div id="countdown">Next page loads in 5 seconds</div>
    <!--<div id="time-elapsed">Elapsed Time: 0s</div>-->

    <div class="center-content">
    
        <h1>Did your partner do a good job?</h1>
        <h2>If yes, press the <span style="color: blue;">left arrow</span> for "Thumbs Up".</h2>
        <h2>If not, press the <span style="color: blue;">right arrow</span> for "Skip".</h2>
        <h2>After making your choice, press the <span style="color: blue;">space bar</span> to confirm.</h2>
        

    </div> 

    <br>

    <div class="thumbs-text" id="button-output"></div> <!-- To display the clicked button -->
            
    <script>
        // Start both countdown and timer
        let countdownValue = 5;
        let selectionMade = false; // To track if a valid selection (left or right arrow) is made

        // Get the current page URL parameters (only once)
        const urlParams = new URLSearchParams(window.location.search);

        // Retrieve the loopCount, score, lines, summary, and reward values from the URL
        const loopCount = parseInt(urlParams.get('loopCount'));  // Default to 1 if not set
        const score = urlParams.get('score') || 0;  // Default to 0 if not set
        const lines = urlParams.get('lines') || 0;  // Default to 0 if not set
        const summary = urlParams.get('summary') || 'noSummary';  // Get 'summary' from URL, default to 'noSummary'
        
        console.log('LoopCount:', loopCount);  // Debugging output
        console.log('Score:', score);          // Debugging output
        console.log('Lines:', lines);          // Debugging output

        // Function to handle keypress events
        function handleKeyPress(event) {
            const output = document.getElementById('button-output');

            // Left Arrow for thumbs up
            if (event.key === "ArrowLeft") {
                selectionMade = true;
                output.innerHTML = "You pressed: Thumbs Up";
                console.log("Thumbs Up selected");
                // You can trigger any action here for thumbs up, like redirecting or calling an API.

            } 
            // Right Arrow for skip
            else if (event.key === "ArrowRight") {
                selectionMade = true;
                output.innerHTML = "You pressed: Skip";
                console.log("Skip selected");
                // Action for skipping, e.g. redirect to a different page.
            }
            // Spacebar for confirm
            else if (event.key === " " && selectionMade) {
    output.innerHTML = "Confirmed";
    output.style.color = "red";  // Change the text color to red
    console.log("Confirm selected");
    //confirmSelection(); // Call the confirm function
} else if (event.key === " " && !selectionMade) {
    output.textContent = "Please make a selection first (Thumbs Up or Skip).";
}
            
        }

        // Function to handle the confirm action after pressing spacebar
        //function confirmSelection() {
            //setTimeout(() => {
                //if (summary === 'summary_Thumbsup') {
                    // Redirect to the summary_Thumbsup.html page with the reward, score, and lines query parameters
                    //window.location.href = `summary_Thumbsup.html?loopCount=${loopCount}&score=${score}&lines=${lines}`;
                //} else {
                    // Redirect to the summary_noThumbsup.html page with the reward, score, and lines query parameters
                    //window.location.href = `summary_noThumbsup.html?loopCount=${loopCount}&score=${score}&lines=${lines}`;
                //}
            //}, 5000); // Redirect after 3 seconds (you can adjust this time)
        //}

        //function confirmSelection() {
    //console.log("Confirming selection...");
    setTimeout(() => {
        // Check if the loopCount is odd or even
        let isThumbsup = (loopCount % 2 === 1); // For odd loop counts, show thumbs up
        console.log("Is Thumbsup:", isThumbsup); // Debugging output

        if (isThumbsup) {
            // Redirect to the thumbs up summary page with the query parameters
            console.log("Redirecting to thumbs up page...");
            window.location.href = `summary_Thumbsup.html?loopCount=${loopCount}&score=${score}&lines=${lines}`;
        } else {
            // Redirect to the no thumbs up summary page with the query parameters
            console.log("Redirecting to no thumbs up page...");
            window.location.href = `summary_noThumbsup.html?loopCount=${loopCount}&score=${score}&lines=${lines}`;
        }
    }, 5000); // Redirect after 5 seconds (you can adjust this time)
//}





        // Attach the keydown event listener
        document.addEventListener('keydown', handleKeyPress);

        const countdownElement = document.getElementById('countdown');
        
        // Countdown function
        function startCountdown() {
            const countdownInterval = setInterval(() => {
                if (countdownValue > 0) {
                    countdownValue--;
                    countdownElement.textContent = `Next page loads in: ${countdownValue} seconds`;
                }
            }, 1000);
        }

        // Start countdown
        startCountdown();
    </script>








<script>
    // Initialize an empty array to store the input data
    let inputs = JSON.parse(localStorage.getItem('userInputs')) || []; // Get previously stored data, or an empty array

    // Get the current page name (you can also hard-code a string like "Game Page")
    let pageName = document.title; // Or use a custom string: "Game Page"

    // Listen for keydown events
    window.addEventListener('keydown', function(event) {
        // Get the current time
        let currentTime = new Date().toLocaleString(); // Use toLocaleString for a human-readable timestamp

        // Check which key was pressed
        let action = '';
        if (event.key === 'ArrowLeft') {
            action = 'Left Arrow';
        } else if (event.key === 'ArrowRight') {
            action = 'Right Arrow';
        } else if (event.key === ' ') {  // Space Bar
            action = 'Space Bar';
        }

        if (action) {
            // Store the input with page name and timestamp
            inputs.push({
                action: action,
                page: pageName,
                time: currentTime
            });

            // Store the updated inputs array back to localStorage
            localStorage.setItem('userInputs', JSON.stringify(inputs));
        }
    });

     // Clear the stored game data in localStorage when the user closes the tab or window
     window.addEventListener('beforeunload', function() {
            // Optionally, remove specific items
            localStorage.removeItem('inputList');
            // Or clear all localStorage data
            // localStorage.clear();
        });

</script>



</body>
</html>
